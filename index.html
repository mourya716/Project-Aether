<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>AETHER // Neural Resonance Engine</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;500;700&family=Syncopate:wght@700&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; overflow: hidden; background-color: #030712; font-family: 'Rajdhani', sans-serif; color: #e2e8f0; }
        canvas { display: block; }
        
        /* UI OVERLAY */
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; padding: 30px; box-sizing: border-box;
            display: flex; flex-direction: column; justify-content: space-between;
            z-index: 10; background: radial-gradient(circle at center, transparent 0%, rgba(3, 7, 18, 0.8) 100%);
        }

        .header h1 {
            font-family: 'Syncopate', sans-serif; font-size: 2rem; margin: 0;
            background: linear-gradient(90deg, #60a5fa, #a78bfa); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .subtitle { font-size: 0.8rem; letter-spacing: 3px; text-transform: uppercase; color: #94a3b8; }

        /* CONTROLS (Center Bottom) */
        #controls {
            pointer-events: auto; display: flex; gap: 15px; justify-content: center; align-items: center;
            background: rgba(15, 23, 42, 0.6); padding: 15px 25px; border-radius: 50px;
            backdrop-filter: blur(10px); border: 1px solid rgba(148, 163, 184, 0.1);
            margin-bottom: 20px;
        }

        .mode-btn {
            background: transparent; border: 1px solid rgba(96, 165, 250, 0.3); color: #94a3b8;
            padding: 10px 20px; border-radius: 30px; cursor: pointer; font-family: 'Rajdhani', sans-serif;
            font-weight: 700; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s ease;
        }

        .mode-btn:hover { background: rgba(96, 165, 250, 0.1); color: #fff; border-color: #60a5fa; }
        
        .mode-btn.active {
            background: #2563eb; color: #fff; border-color: #2563eb;
            box-shadow: 0 0 15px rgba(37, 99, 235, 0.5);
        }

        /* START SCREEN */
        #start-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #030712; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 100; transition: opacity 0.8s ease;
        }

        #init-btn {
            margin-top: 30px; padding: 15px 50px; background: transparent;
            border: 2px solid #60a5fa; color: #60a5fa; font-family: 'Syncopate', sans-serif;
            font-weight: 700; cursor: pointer; transition: all 0.3s; letter-spacing: 2px;
        }
        #init-btn:hover { background: #60a5fa; color: #000; box-shadow: 0 0 30px rgba(96, 165, 250, 0.6); }

        /* BREATH GUIDE */
        #breath-text {
            position: absolute; top: 45%; left: 50%; transform: translate(-50%, -50%);
            font-family: 'Syncopate', sans-serif; font-size: 0.9rem; letter-spacing: 5px;
            color: rgba(255,255,255,0.4); pointer-events: none; transition: opacity 1s;
        }
    </style>
</head>
<body>

    <div id="start-overlay">
        <h1 style="font-family: 'Syncopate'; color: white; font-size: 3rem;">AETHER</h1>
        <p style="color: #94a3b8; margin-top: 10px; letter-spacing: 2px;">NEURAL RESONANCE & FOCUS ENGINE</p>
        <button id="init-btn">INITIALIZE SYSTEM</button>
        <p style="margin-top: 20px; font-size: 0.8rem; color: #475569;">[ HEADPHONES REQUIRED FOR BINAURAL AUDIO ]</p>
    </div>

    <div id="ui-layer">
        <div class="header">
            <h1>AETHER</h1>
            <div class="subtitle">Mourya.AI // Digital Dhyana Interface</div>
        </div>
        
        <div id="breath-text">INHALE</div>

        <div style="width: 100%; display: flex; justify-content: center;">
            <div id="controls">
                <button class="mode-btn active" onclick="setMode('focus')">Deep Work (Gamma)</button>
                <button class="mode-btn" onclick="setMode('relax')">Meditate (Theta)</button>
                <button class="mode-btn" onclick="setMode('sleep')">Rest (Delta)</button>
                <div style="width: 1px; height: 20px; background: rgba(255,255,255,0.2); margin: 0 10px;"></div>
                <button class="mode-btn" style="border-color: #ef4444;" onclick="toggleMute()" id="mute-btn">STOP</button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. NEURAL AUDIO ENGINE (Binaural Beats) ---
        class NeuralEngine {
            constructor() {
                this.ctx = null;
                this.leftOsc = null;
                this.rightOsc = null;
                this.gainNode = null;
                this.isMuted = false;
                this.currentMode = 'focus';
            }

            init() {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                this.ctx = new AudioContext();
                this.gainNode = this.ctx.createGain();
                this.gainNode.gain.value = 0.1; // Master volume
                this.gainNode.connect(this.ctx.destination);
                this.startOscillators();
            }

            startOscillators() {
                this.leftOsc = this.ctx.createOscillator();
                this.rightOsc = this.ctx.createOscillator();
                
                // Stereo Panning
                const pannerLeft = this.ctx.createStereoPanner();
                const pannerRight = this.ctx.createStereoPanner();
                pannerLeft.pan.value = -1; // Left Ear
                pannerRight.pan.value = 1; // Right Ear

                this.leftOsc.connect(pannerLeft);
                this.rightOsc.connect(pannerRight);
                
                pannerLeft.connect(this.gainNode);
                pannerRight.connect(this.gainNode);

                this.leftOsc.start();
                this.rightOsc.start();
                
                this.setFrequency(40, 440); // Default Focus
            }

            setFrequency(beatFreq, carrierFreq) {
                // Binaural Logic: Left = Carrier, Right = Carrier + Beat
                const now = this.ctx.currentTime;
                this.leftOsc.frequency.linearRampToValueAtTime(carrierFreq, now + 1);
                this.rightOsc.frequency.linearRampToValueAtTime(carrierFreq + beatFreq, now + 1);
            }

            toggleMute() {
                if(this.isMuted) {
                    this.gainNode.gain.setTargetAtTime(0.1, this.ctx.currentTime, 0.5);
                    this.isMuted = false;
                    document.getElementById('mute-btn').innerText = "STOP";
                } else {
                    this.gainNode.gain.setTargetAtTime(0, this.ctx.currentTime, 0.5);
                    this.isMuted = true;
                    document.getElementById('mute-btn').innerText = "RESUME";
                }
            }
        }

        const audio = new NeuralEngine();

        // --- 2. 3D VISUALS (Digital Prana) ---
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x030712, 0.002);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 100;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Core Breathing Sphere
        const coreGeo = new THREE.IcosahedronGeometry(10, 2);
        const coreMat = new THREE.MeshBasicMaterial({ 
            color: 0x60a5fa, wireframe: true, transparent: true, opacity: 0.5 
        });
        const core = new THREE.Mesh(coreGeo, coreMat);
        scene.add(core);

        // Neural Particles
        const particlesGeo = new THREE.BufferGeometry();
        const count = 800;
        const posArray = new Float32Array(count * 3);
        
        for(let i=0; i<count*3; i++) {
            posArray[i] = (Math.random() - 0.5) * 300;
        }
        
        particlesGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const particlesMat = new THREE.PointsMaterial({
            size: 1.5, color: 0xa78bfa, transparent: true, opacity: 0.8, blending: THREE.AdditiveBlending
        });
        const particleSystem = new THREE.Points(particlesGeo, particlesMat);
        scene.add(particleSystem);

        // Neural Connections (Lines)
        const lineMat = new THREE.LineBasicMaterial({ color: 0x60a5fa, transparent: true, opacity: 0.15 });
        const lineGeo = new THREE.BufferGeometry();
        const lines = new THREE.LineSegments(lineGeo, lineMat);
        scene.add(lines);

        // --- 3. LOGIC & ANIMATION ---
        let mode = 'focus';
        let breathSpeed = 0.002;
        let time = 0;

        // MODES
        window.setMode = (selectedMode) => {
            mode = selectedMode;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');

            if (mode === 'focus') {
                audio.setFrequency(40, 432); // Gamma (Focus) - 40Hz beat
                breathSpeed = 0.003; // Fast, energetic breath
                coreMat.color.setHex(0x60a5fa); // Blue
                particlesMat.color.setHex(0xa78bfa);
            } else if (mode === 'relax') {
                audio.setFrequency(7, 200); // Theta (Meditation) - 7Hz beat
                breathSpeed = 0.0015; // Slow, deep breath (4-7-8 rhythm)
                coreMat.color.setHex(0x34d399); // Green
                particlesMat.color.setHex(0x6ee7b7);
            } else if (mode === 'sleep') {
                audio.setFrequency(2, 100); // Delta (Sleep) - 2Hz beat
                breathSpeed = 0.0008; // Very slow
                coreMat.color.setHex(0xf472b6); // Pink/Purple
                particlesMat.color.setHex(0xfbcfe8);
            }
        };

        window.toggleMute = () => audio.toggleMute();

        function animate() {
            requestAnimationFrame(animate);
            time += breathSpeed;

            // Breathing Logic (Sine Wave)
            const breath = Math.sin(time * 2) * 0.5 + 1.5; // Scale between 1 and 2
            core.scale.set(breath, breath, breath);
            core.rotation.y += 0.005;
            core.rotation.z += 0.002;

            // Update Breath Text
            const breathText = document.getElementById('breath-text');
            if (Math.sin(time * 2) > 0) {
                breathText.innerText = "INHALE";
                breathText.style.opacity = Math.sin(time * 2);
            } else {
                breathText.innerText = "EXHALE";
                breathText.style.opacity = Math.abs(Math.sin(time * 2));
            }

            // Particle Physics
            particleSystem.rotation.y += 0.001;
            
            // Draw Connections dynamically (only near particles)
            // *Optimization: Only connecting subset to save CPU*
            const positions = particleSystem.geometry.attributes.position.array;
            const linePositions = [];
            
            // Simple rotation effect on particles
            for(let i=0; i<count; i+=3) {
               // Gentle float
               positions[i+1] += Math.sin(time + positions[i]) * 0.02;
            }
            particleSystem.geometry.attributes.position.needsUpdate = true;

            renderer.render(scene, camera);
        }

        // Init
        document.getElementById('init-btn').addEventListener('click', () => {
            audio.init();
            document.getElementById('start-overlay').style.opacity = 0;
            setTimeout(() => document.getElementById('start-overlay').style.display = 'none', 800);
            animate();
        });

        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>
</html>
